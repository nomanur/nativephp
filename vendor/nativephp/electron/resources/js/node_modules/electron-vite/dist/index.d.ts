/// <reference types="node" />

import { ConfigEnv } from 'vite';
import { createLogger } from 'vite';
import { defineConfig as defineViteConfig } from 'vite';
import type { FilterPattern } from 'vite';
import { LogLevel } from 'vite';
import { Plugin } from 'vite';
import { splitVendorChunk } from 'vite';
import { splitVendorChunkPlugin } from 'vite';
import type { TransformConfig } from '@swc/core';
import { UserConfig as UserConfig_2 } from 'vite';
import { UserConfigExport as UserConfigExport_2 } from 'vite';

/**
 * Bundles the electron app for production.
 */
export declare function build(inlineConfig?: InlineConfig): Promise<void>;

export declare interface BytecodeOptions {
    chunkAlias?: string | string[];
    transformArrowFunctions?: boolean;
    removeBundleJS?: boolean;
    protectedStrings?: string[];
}

/**
 * Compile to v8 bytecode to protect source code.
 */
export declare function bytecodePlugin(options?: BytecodeOptions): Plugin | null;

export { createLogger }

export declare function createServer(inlineConfig: InlineConfig | undefined, options: {
    rendererOnly?: boolean;
}): Promise<void>;

/**
 * Type helper to make it easier to use `electron.vite.config.*`
 * accepts a direct {@link UserConfig} object, or a function that returns it.
 * The function receives a object that exposes two properties:
 * `command` (either `'build'` or `'serve'`), and `mode`.
 */
export declare function defineConfig(config: UserConfigExport): UserConfigExport;

export { defineViteConfig }

/**
 * Automatically externalize dependencies
 */
export declare function externalizeDepsPlugin(options?: ExternalOptions): Plugin | null;

export declare interface ExternalOptions {
    exclude?: string[];
    include?: string[];
}

export declare type InlineConfig = Omit<UserConfig_2, 'base'> & {
    configFile?: string | false;
    envFile?: false;
    ignoreConfigWarning?: boolean;
};

export declare function loadConfigFromFile(configEnv: ConfigEnv, configFile?: string, configRoot?: string, logLevel?: LogLevel, ignoreConfigWarning?: boolean): Promise<{
    path: string;
    config: UserConfig;
    dependencies: string[];
}>;

/**
 * Load `.env` files within the `envDir`(default: `process.cwd()`).
 * By default, only env variables prefixed with `MAIN_VITE_`, `PRELOAD_VITE_` and
 * `RENDERER_VITE_` are loaded, unless `prefixes` is changed.
 */
export declare function loadEnv(mode: string, envDir?: string, prefixes?: string | string[]): Record<string, string>;

export { LogLevel }

export declare function preview(inlineConfig: InlineConfig | undefined, options: {
    skipBuild?: boolean;
}): Promise<void>;

export declare function resolveConfig(inlineConfig: InlineConfig, command: 'build' | 'serve', defaultMode?: string): Promise<ResolvedConfig>;

export declare interface ResolvedConfig {
    config?: UserConfig;
    configFile?: string;
    configFileDependencies: string[];
}

export { splitVendorChunk }

export { splitVendorChunkPlugin }

export declare type SwcOptions = {
    include?: FilterPattern;
    exclude?: FilterPattern;
    transformOptions?: TransformConfig;
};

/**
 * Use SWC to support for emitting type metadata for decorators.
 * When using `swcPlugin`, you need to install `@swc/core`.
 */
export declare function swcPlugin(options?: SwcOptions): Plugin;

export declare interface UserConfig {
    /**
     * Vite config options for electron main process
     *
     * https://cn.vitejs.dev/config/
     */
    main?: UserConfig_2 & {
        configFile?: string | false;
    };
    /**
     * Vite config options for electron renderer process
     *
     * https://cn.vitejs.dev/config/
     */
    renderer?: UserConfig_2 & {
        configFile?: string | false;
    };
    /**
     * Vite config options for electron preload files
     *
     * https://cn.vitejs.dev/config/
     */
    preload?: UserConfig_2 & {
        configFile?: string | false;
    };
}

export declare type UserConfigExport = UserConfigSchema | Promise<UserConfigSchema> | UserConfigFn;

export declare type UserConfigFn = (env: ConfigEnv) => UserConfigSchema | Promise<UserConfigSchema>;

export declare interface UserConfigSchema {
    /**
     * Vite config options for electron main process
     *
     * https://cn.vitejs.dev/config/
     */
    main?: UserConfigExport_2;
    /**
     * Vite config options for electron renderer process
     *
     * https://cn.vitejs.dev/config/
     */
    renderer?: UserConfigExport_2;
    /**
     * Vite config options for electron preload files
     *
     * https://cn.vitejs.dev/config/
     */
    preload?: UserConfigExport_2;
}

export { }
